name: Morpho TVL Telegram Alert

on:
  schedule:
    - cron: '0 7 * * *'   # 09:00 CEST ogni giorno
  workflow_dispatch:

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Check TVL & Send Telegram
        run: |
          sudo apt-get update && sudo apt-get install -y jq

          echo "ðŸ“¡ Recupero TVL da Morpho..."

          API_URL="https://blue-api.morpho.org/vaults/0xbEef047a543E45807105E51A8BBEFCc5950fcfBa"
          RESPONSE=$(curl -s "$API_URL")
          TVL=$(echo "$RESPONSE" | jq -r '.totalAssetsUsd // "error"')
          APY=$(echo "$RESPONSE" | jq -r '.netApy // empty')

          echo "DEBUG: TVL = $TVL"
          echo "DEBUG: APY = $APY"

          if [[ "$]()]()
